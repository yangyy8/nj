webpackJsonp([27],{SSps:function(t,e){},b3Ky:function(t,e){},zymA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,s,o,l=a("+5I8");function r(t,e,a,i){var o=L.divIcon({html:"<div style='line-height:40px;text-align:center;font-weight:bold'>"+a+"</div>",className:"my-div-icon lz",iconSize:50}),l=L.marker(t,{icon:o,pcsdm:e,pcsmc:i,num:a});s.addLayer(l),s.on("mousemove",function(t){t.layer.bindPopup("<div style='font-weight:bold; font-size: 13px; padding-bottom:5px'>"+t.layer.options.pcsmc+"</div><div>总人数："+t.layer.options.num+"</div>").openPopup()}),s.on("mouseout",function(t){t.layer.closePopup()}),l.on("click",function(t){window.zdvm.getRyxx(1,5,e,i,"")})}var n={inject:["reload"],data:function(){return{CurrentPage:1,pageSize:5,TotalResult:0,pd:{},swdw:[],show:!0,bzhshow:!1,lgshow:!1,czshow:!1,sjshow:!0,pcs:[],xzqh:[],radioe:"2",tableData:[],bzhDialogVisible:!1,diatext:"标准化地址",bzhid:"",mc:"",lrdw:""}},mounted:function(){window.zdvm=this,this.$store.dispatch("getGjdq"),this.$store.dispatch("getQzzl"),i=L.map("mainMap",{crs:L.CRS.EPSG4326,preferCanvas:!0,center:[32.03613281,118.78211975],maxZoom:18,minZoom:11,zoom:15,zoomControl:!0,attributionControl:!1,closePopupOnClick:!1}),L.supermap.wmtsLayer("http://10.33.66.183:2333/iserver/services/map-wmts-GADT/wmts-china",{layer:"GADT",style:"default",tilematrixSet:"ChinaPublicServices_GADT",format:"image/png",transparent:!0}).addTo(i),s=L.featureGroup().addTo(i)},methods:{pageSizeChange:function(t){this.getRyxx(this.CurrentPage,t,this.bzhid,this.mc,this.lrdw),console.log("每页 "+t+" 条")},handleCurrentChange:function(t){this.getRyxx(t,this.pageSize,this.bzhid,this.mc,this.lrdw),console.log("当前页: "+t)},changtab:function(){this.show=!this.show},changeTSY:function(t){"1"==t?(this.lgshow=!0,this.bzhshow=!1):"2"==t?(this.lgshow=!1,this.bzhshow=!0):(this.lgshow=!1,this.bzhshow=!1)},getPcs:function(){var t=this,e=this.Global.aport1+this.Global.pcs;this.$api.get(e,null,function(e){t.pcs=Object(l.a)(e.data)})},getXzqh:function(){var t=this,e=this.Global.aport1+this.Global.xzqh;this.$api.get(e,null,function(e){t.xzqh=Object(l.a)(e.data)})},doset:function(){this.reload()},getSearch:function(t){"2"!=this.radioe||void 0!=this.pd.beginTime||void 0!=this.pd.endTime?function(t){null!=s&&s.clearLayers(),null!=o&&(o.remove(),i.removeLayer(o));var e=new L.Control.Draw({position:"topleft",draw:{polyline:!1,polygon:{},circle:{},rectangle:{},marker:!1,remove:!0,circlemarker:!1}});i.addControl(e),i.on(L.Draw.Event.CREATED,function(t){var e=[];if("circle"==t.layerType){t.layer.getLatLng();var a=t.layer.getRadius();L.supermap.plotting.query(i).getGObjectsInCircle(s,a)}else for(var s=t.layer.getLatLngs(),l=s[0],n=0;n<l.length+1;n++){var c=[];n==l.length?(c.push(l[0].lat),c.push(l[0].lng)):(c.push(l[n].lat),c.push(l[n].lng)),e.push(c)}(o=L.polygon(e)).addTo(i);var d=new SuperMap.GetFeaturesByGeometryParameters({datasetNames:["ORCL_gt8:dz_mlp"],geometry:o,spatialQueryMode:"INTERSECT",maxFeatures:3e5,fromIndex:0,toIndex:3e5});L.supermap.featureService("http://10.33.66.183:2333/iserver/services/data-gt8/rest/data").getFeaturesByGeometry(d,function(t){var e=t.result.features.features;console.log("resultdata.length",e.length);for(var a=[],i=[],s=0;s<e.length;s++){var o=e[s].properties.DZMC.split("号"),l=e[s].properties.PCS,n=e[s].geometry.coordinates.reverse(),c=new Object;c.dm=o[0]+"号",c.zb=n,a.push(c),-1==i.indexOf(l)&&i.push(l)}window.zdvm.getbzhdz(a,i,function(t){for(var e=0;e<t.length;e++){var a=t[e].dm.split("号")[0]+"号";r(t[e].zb,a,t[e].count,a)}})})}),$("."+t)[0].click()}(t):this.$message.error("请输入开始时间或者结束时间！")},getbzhdz:function(t,e,a){for(var i=this,s=[],o=[],l=0;l<t.length;l++){o.find(function(e){return e.dm==t[l].dm})||o.push(t[l])}console.log("bb",o.length),console.log("pp",e);var r={},n="";"1"==this.radioe?(this.czshow=!0,r={rzsjStart:this.pd.beginTime,rzsjEnd:this.pd.endTime,gjdq:this.pd.gjdq,qzzl:this.pd.qzzl,arrayList:o,pcsList:e},n=this.Global.aport+"/ywczdt/getZdjkqyBzhdz"):(r={rzsjStart:this.pd.beginTime,rzsjEnd:this.pd.endTime,gjdq:this.pd.gjdq,qzzl:this.pd.qzzl,arrayList:o,pcsList:e},this.czshow=!1,n=this.Global.aport+"/ywlz/getZdjkqyBzhdz"),this.$api.post(n,r,function(t){if(t.success){for(var e=t.data,o=0;o<e.length;o++)s.push(e[o]);if(0==s.length)return void i.$message.error("地图库中未录入该地址的坐标! ");a&&a(s)}})},getRyxx:function(t,e,a,i,s){var o=this;1==t&&(this.CurrentPage=1,this.tableData=[],this.TotalResult=0),this.bzhid=a,this.mc=i,this.lrdw=s,this.diatext=this.mc;var l={},r="";"1"==this.radioe?(l={currentPage:t,showCount:e,xxdz:this.bzhid,djrqStart:this.pd.beginTime,djrqEnd:this.pd.endTime,gjdq:this.pd.gjdq,qzzl:this.pd.qzzl},r=this.Global.aport+"/ywczdt/getCZDJXXRYList"):(l={currentPage:t,showCount:e,bzhdzMc:this.bzhid,rzsjStart:this.pd.beginTime,rzsjEnd:this.pd.endTime,gjdq:this.pd.gjdq,qzzl:this.pd.qzzl},r=this.Global.aport+"/zxdt/getLSZSDJXXRYList"),this.$api.post(r,l,function(t){t.success&&(o.tableData=t.data.resultList,o.TotalResult=t.data.totalResult)}),this.bzhDialogVisible=!0},getBX:function(t){console.log(t),this.sjshow=1!=t},getXY:function(t,e){var a={url:this.Global.xyaddress+"?dz="+t};this.$api.post(this.Global.aport+"/zxdt/getCtUrl",a,function(t){e&&e(t.data.result)})},gotos:function(t,e){var a=this.$router.resolve({path:"/Home/RYHX_NX",query:{zjhm:t,gjdq:e}});window.open(a.href,"_blank")}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"yymain "},[i("div",{staticClass:"mapbj lzxx",attrs:{id:"mainMap"}}),t._v(" "),i("div",{staticClass:"fxleft"},[i("div",{staticClass:"fxbnt"},[t.show?i("el-button",{staticStyle:{"border-radius":"0px!important","border-width":"1px 1px 0px 1px"},attrs:{size:"mini",type:"primary",icon:"iconfont el-icon-yy-xiangshangjiantou"},on:{click:function(e){t.changtab()}}}):i("el-button",{staticStyle:{"border-radius":"0px!important"},attrs:{size:"mini",type:"primary",icon:"iconfont el-icon-yy-xiangxiajiantou"},on:{click:function(e){t.changtab()}}})],1),t._v(" "),i("el-collapse-transition",[t.show?i("div",{staticClass:"fxcont"},[i("el-row",{attrs:{gutter:1}},[i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("类别：")]),t._v(" "),i("el-radio",{attrs:{value:"1",label:"1"},on:{change:function(e){t.getBX(1)}},model:{value:t.radioe,callback:function(e){t.radioe=e},expression:"radioe"}},[t._v("常住")]),t._v(" "),i("el-radio",{attrs:{value:"2",label:"2"},on:{change:function(e){t.getBX(2)}},model:{value:t.radioe,callback:function(e){t.radioe=e},expression:"radioe"}},[t._v("临住")])],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t.sjshow?i("font",{attrs:{color:"red"}},[t._v("*")]):t._e(),t._v(" 时间范围：")],1),t._v(" "),i("el-date-picker",{staticClass:"yy-input-input",attrs:{format:"yyyy-MM-dd",type:"date",size:"small","value-format":"yyyy/MM/dd",placeholder:"开始时间"},model:{value:t.pd.beginTime,callback:function(e){t.$set(t.pd,"beginTime",e)},expression:"pd.beginTime"}})],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"}),t._v(" "),i("el-date-picker",{staticClass:"yy-input-input",attrs:{format:"yyyy-MM-dd",type:"date",size:"small","value-format":"yyyy/MM/dd",placeholder:"结束时间"},model:{value:t.pd.endTime,callback:function(e){t.$set(t.pd,"endTime",e)},expression:"pd.endTime"}})],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("国家地区：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},model:{value:t.pd.gjdq,callback:function(e){t.$set(t.pd,"gjdq",e)},expression:"pd.gjdq"}},t._l(t.$store.state.gjdq,function(t,e){return i("el-option",{key:e,attrs:{label:t.mc,value:t.dm}})}),1)],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("签证种类：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},model:{value:t.pd.qzzl,callback:function(e){t.$set(t.pd,"qzzl",e)},expression:"pd.qzzl"}},t._l(t.$store.state.qzzl,function(t,e){return i("el-option",{key:e,attrs:{label:t.mc,value:t.dm}})}),1)],1)],1),t._v(" "),i("el-row",{attrs:{type:"flex"}},[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.getSearch("leaflet-draw-draw-polygon")}}},[t._v("多边形")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.getSearch("leaflet-draw-draw-rectangle")}}},[t._v("矩形")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.doset()}}},[t._v("重置")])],1)],1)],1):t._e()])],1),t._v(" "),i("div",{staticClass:"bghome"},[i("el-dialog",{attrs:{title:t.diatext,visible:t.bzhDialogVisible},on:{"update:visible":function(e){t.bzhDialogVisible=e}}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[i("el-table-column",{attrs:{label:"照片"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.zp?i("div",[i("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[i("img",{staticStyle:{"max-width":"700px","max-height":"700px"},attrs:{src:e.row.zp}}),t._v(" "),i("img",{attrs:{slot:"reference",src:e.row.zp,alt:e.row.zp,width:"50",height:"50"},slot:"reference"})])],1):t._e()]}}])}),t._v(" "),t.czshow?i("el-table-column",{attrs:{prop:"sf",label:"身份"}}):t._e(),t._v(" "),t.czshow?i("el-table-column",{attrs:{prop:"fwcs",label:"服务处所"}}):t._e(),t._v(" "),i("el-table-column",{attrs:{prop:"ywxm",label:"英文姓名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"zwxm",label:"中文姓名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"xb",label:"性别",width:"60"}}),t._v(" "),i("el-table-column",{attrs:{prop:"csrq",label:"出生日期"}}),t._v(" "),i("el-table-column",{attrs:{prop:"djrq",label:"登记日期"}}),t._v(" "),i("el-table-column",{attrs:{prop:"gjdq",label:"国家地区"}}),t._v(" "),i("el-table-column",{attrs:{prop:"zjzl",label:"证件种类"}}),t._v(" "),i("el-table-column",{attrs:{prop:"zjhm",label:"证件号码"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"yellow",cursor:"pointer"},on:{click:function(a){t.gotos(e.row.zjhm,e.row.gjdqdm)}}},[t._v(t._s(e.row.zjhm))])]}}])})],1),t._v(" "),i("div",{staticClass:"middle-foot mt-10"},[i("div",{staticClass:"page-msg"},[i("div",{staticClass:"crrcolor"},[t._v("\n              共"+t._s(t.TotalResult)+"条记录\n              ")]),t._v(" "),i("div",{staticClass:"crrcolor"}),t._v(" "),i("div",{staticClass:"crrcolor"})]),t._v(" "),i("el-pagination",{attrs:{background:"","current-page":t.CurrentPage,"page-size":t.pageSize,layout:"prev, pager, next",total:t.TotalResult},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.CurrentPage=e}}})],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("img",{staticStyle:{cursor:"pointer"},attrs:{src:a("JmKm"),border:"0"},on:{click:function(e){t.bzhDialogVisible=!1}}})]),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{left:"0px",top:"0px","border-bottom-width":"0","border-right-width":"0"}}),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{right:"0px",top:"0px","border-bottom-width":"0","border-left-width":"0"}}),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{left:"0px",bottom:"0px","border-top-width":"0","border-right-width":"0"}}),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{right:"0px",bottom:"0px","border-top-width":"0","border-left-width":"0"}})],1)],1)])},staticRenderFns:[]};var d=a("VU/8")(n,c,!1,function(t){a("SSps"),a("b3Ky")},"data-v-97836520",null);e.default=d.exports}});
//# sourceMappingURL=27.e22b38b3002d1eaa9c20.js.map