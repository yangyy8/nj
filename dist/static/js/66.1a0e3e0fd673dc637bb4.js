webpackJsonp([66],{ij2k:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,a,l,o=s("+5I8"),r=s("I9qK"),n=s("bOdI"),c=s.n(n);function p(t,e){a.clearLayers();var s=new SuperMap.GetFeaturesBySQLParameters({queryParameter:{name:"dz_mlp@ORCL_gt8",attributeFilter:"DZMC='"+t+"'"},datasetNames:["ORCL_gt8:dz_mlp"]}),i=[];L.supermap.featureService("http://10.33.66.183:2333/iserver/services/data-gt8/rest/data").getFeaturesBySQL(s,function(s){if((i=s.result.features.features).length>0){var a=i[0].properties.SMX,l=i[0].properties.SMY,o=[];o.push(l),o.push(a),d(o,e,t,t)}else window.lzvm.getXY(t,function(s){if(void 0!=s&&s.ycoord>0&&s.xcoord>0){var i=[];i.push(s.ycoord),i.push(s.xcoord),d(i,e,t,t)}})})}function d(t,e,s,i){var l=L.divIcon({html:"<div style='line-height:38px;text-align:center;'>"+e+"</div>",className:"my-div-icon lzgreen",iconSize:50}),o=L.marker(t,{icon:l,pcsdm:s,pcsmc:i,num:e});a.addLayer(o),a.on("mousemove",function(t){t.layer.bindPopup("<div style='font-weight:bold; font-size: 13px; padding-bottom:5px'>"+t.layer.options.pcsmc+"</div><div>总人数："+t.layer.options.num+"</div>").openPopup()}),a.on("mouseout",function(t){t.layer.closePopup()}),o.on("click",function(t){window.lzvm.getRyxx(1,5,s,s)})}var u={data:function(){return{CurrentPage:1,pageSize:5,TotalResult:0,allUserList:{},pd:{},swdw:[],show:!0,bzhshow:!1,lgshow:!1,zsbg:[],list:[],tableData:[],ssfj:[],loading:!1,lzhDialogVisible:!1,diatext:"标准化地址",bzhid:"",mc:"",lrdw:"",centers:[32.03613281,118.78211975]}},mounted:function(){var t;window.lzvm=this,this.$store.dispatch("getGjdq"),this.$store.dispatch("getRjsy"),this.$store.dispatch("getZjzl"),this.$store.dispatch("getRjqzzl"),this.pd.beginTime=Object(r.b)(Object(r.c)(),"yyyy-MM-dd"),this.pd.endTime=Object(r.b)(Object(r.c)(),"yyyy-MM-dd"),i=L.map("mainMap",(t={crs:L.CRS.EPSG4326,preferCanvas:!0,center:[32.03613281,118.78211975],maxZoom:18,zoom:10},c()(t,"maxZoom",16),c()(t,"zoomControl",!1),c()(t,"attributionControl",!1),c()(t,"closePopupOnClick",!1),t)),L.supermap.wmtsLayer("http://10.33.66.183:2333/iserver/services/map-wmts-GADT/wmts-china",{layer:"GADT",style:"default",tilematrixSet:"ChinaPublicServices_GADT",format:"image/png",transparent:!0}).addTo(i),a=L.featureGroup().addTo(i),new SuperMap.ElasticSearch("http://10.33.69.24:9200/"),this.getFJ(),this.getUserWhiteList()},methods:{userFilter:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.allUserList.filter(function(e){if(void 0!=e.mc)return e.mc.includes(t)});e.length>50?this.zsbg=e.slice(0,50):this.zsbg=e},getUserWhiteList:function(){var t=this;this.$api.get(this.Global.aport1+this.Global.zsbg,null,function(e){t.allUserList=Object(o.a)(e.data),t.userFilter()})},pageSizeChange:function(t){this.getRyxx(this.CurrentPage,t,this.bzhid,this.mc),console.log("每页 "+t+" 条")},handleCurrentChange:function(t){this.getRyxx(t,this.pageSize,this.bzhid,this.mc),console.log("当前页: "+t)},getFJ:function(){var t=this,e={operatorId:this.$store.state.uid,operatorNm:this.$store.state.uname};this.$api.post(this.Global.aport2+"/data_report/selectSsfjDm",e,function(e){t.ssfj=Object(o.b)(e.data.SSFJ,"dm")})},changtab:function(){this.show=!this.show},changeTSY:function(t){"2"==t?(this.lgshow=!0,this.bzhshow=!1):"1"==t?(this.lgshow=!1,this.bzhshow=!0):(this.lgshow=!1,this.bzhshow=!1)},getZsbg:function(){var t=this,e=this.Global.aport1+this.Global.zsbg;this.$api.get(e,null,function(e){t.list=Object(o.a)(e.data)})},doset:function(){this.$set(this.pd,"zjzl",""),this.$set(this.pd,"qzzl",""),this.$set(this.pd,"gjdq",""),this.$set(this.pd,"tlsy",""),this.$set(this.pd,"ssfj",""),this.$set(this.pd,"beginTime",""),this.$set(this.pd,"endTime",""),this.$set(this.pd,"tsj",""),this.$set(this.pd,"bzhdz",""),this.$set(this.pd,"zsbg","")},doSearch:function(){var t;void 0!=this.pd.beginTime||void 0!=this.pd.endTime?(t=this.centers,null!=l&&l.clearLayers(),i.flyTo(t,11),a.clearLayers(),window.lzvm.getBZHDZ(function(t){if(t.length>0)for(var e=0;e<t.length;e++)p(t[e].dm,t[e].count)})):this.$message.error("请输入住宿的开始时间或结束时间!")},getBZHDZ:function(t){var e=this,s=[],i={zjzl:this.pd.zjzl,qzzl:this.pd.qzzl,gjdq:this.pd.gjdq,tlsy:this.pd.tlsy,rzsjStart:this.pd.beginTime,rzsjEnd:this.pd.endTime,zsbg:this.pd.zsbg,likeBzhdzMc:this.pd.bzhdz,ssfj:this.pd.ssfj.substr(0,6),tsy:this.pd.tsj},a=this.Global.aport+"/zxdt/getLSZSDJXXBZHDZList";this.$api.post(a,i,function(i){if(i.success){for(var a=i.data,l=0;l<a.length;l++)s.push(a[l]);if(0==s.length)return void e.$message.error("没有查询到数据信息! ");t&&t(s)}})},getRyxx:function(t,e,s,i){var a=this;1==t&&(this.CurrentPage=1,this.tableData=[],this.TotalResult=0,this.bzhid=s,this.mc=i),this.diatext=this.mc;var l={currentPage:t,showCount:e,bzhdzMc:this.bzhid,zjzl:this.pd.zjzl,qzzl:this.pd.qzzl,gjdq:this.pd.gjdq,tlsy:this.pd.tlsy,rzsjStart:this.pd.beginTime,rzsjEnd:this.pd.endTime,zsbg:this.pd.zsbg,ssfj:this.pd.ssfj.substr(0,6),tsy:this.pd.tsj},o=this.Global.aport+"/zxdt/getLSZSDJXXRYList";this.$api.post(o,l,function(t){t.success&&(console.log(t.data),a.tableData=t.data.resultList,a.TotalResult=t.data.totalResult)}),this.lzhDialogVisible=!0},getXY:function(t,e){var s={url:this.Global.xyaddress+"?dz="+t};this.$api.post(this.Global.aport+"/zxdt/getCtUrl",s,function(t){e&&e(t.data.result)})},gotos:function(t,e){var s=this.$router.resolve({path:"/Home/RYHX_NX",query:{zjhm:t,gjdq:e}});window.open(s.href,"_blank")}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"yymain "},[i("div",{staticClass:"mapbj lzxx",attrs:{id:"mainMap"}}),t._v(" "),i("div",{staticClass:"fxleft"},[i("div",{staticClass:"fxbnt"},[t.show?i("el-button",{staticStyle:{"border-radius":"0px!important","border-width":"1px 1px 0px 1px"},attrs:{size:"mini",type:"primary",icon:"iconfont el-icon-yy-xiangshangjiantou"},on:{click:function(e){t.changtab()}}}):i("el-button",{staticStyle:{"border-radius":"0px!important"},attrs:{size:"mini",type:"primary",icon:"iconfont el-icon-yy-xiangxiajiantou"},on:{click:function(e){t.changtab()}}})],1),t._v(" "),i("el-collapse-transition",[t.show?i("div",{staticClass:"fxcont"},[i("el-row",{attrs:{gutter:1}},[i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("所属分局：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},model:{value:t.pd.ssfj,callback:function(e){t.$set(t.pd,"ssfj",e)},expression:"pd.ssfj"}},t._l(t.ssfj,function(t,e){return i("el-option",{key:e,attrs:{label:t.mc,value:t.dm}})}),1)],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[i("font",{attrs:{color:"red"}},[t._v("*")]),t._v(" 住宿时间：")],1),t._v(" "),i("el-date-picker",{staticClass:"yy-input-input",attrs:{format:"yyyy-MM-dd",type:"date",size:"small","value-format":"yyyy/MM/dd",placeholder:"开始时间"},model:{value:t.pd.beginTime,callback:function(e){t.$set(t.pd,"beginTime",e)},expression:"pd.beginTime"}})],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"}),t._v(" "),i("el-date-picker",{staticClass:"yy-input-input",attrs:{format:"yyyy-MM-dd",type:"date",size:"small","value-format":"yyyy/MM/dd",placeholder:"结束时间"},model:{value:t.pd.endTime,callback:function(e){t.$set(t.pd,"endTime",e)},expression:"pd.endTime"}})],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("证件种类：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},model:{value:t.pd.zjzl,callback:function(e){t.$set(t.pd,"zjzl",e)},expression:"pd.zjzl"}},t._l(t.$store.state.zjzl,function(t,e){return i("el-option",{key:e,attrs:{label:t.mc,value:t.dm}})}),1)],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("签证种类：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},model:{value:t.pd.qzzl,callback:function(e){t.$set(t.pd,"qzzl",e)},expression:"pd.qzzl"}},t._l(t.$store.state.rjqzzl,function(t,e){return i("el-option",{key:e,attrs:{label:t.mc,value:t.dm}})}),1)],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("国家地区：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},model:{value:t.pd.gjdq,callback:function(e){t.$set(t.pd,"gjdq",e)},expression:"pd.gjdq"}},t._l(t.$store.state.gjdq,function(t,e){return i("el-option",{key:e,attrs:{label:t.mc,value:t.dm}})}),1)],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("停留事由：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},model:{value:t.pd.tlsy,callback:function(e){t.$set(t.pd,"tlsy",e)},expression:"pd.tlsy"}},t._l(t.$store.state.rjsy,function(t,e){return i("el-option",{key:e,attrs:{label:t.mc,value:t.dm}})}),1)],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("投宿于：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择",size:"small"},on:{change:function(e){t.changeTSY(t.pd.tsj)}},model:{value:t.pd.tsj,callback:function(e){t.$set(t.pd,"tsj",e)},expression:"pd.tsj"}},[i("el-option",{attrs:{label:"旅馆",value:"2"}}),t._v(" "),i("el-option",{attrs:{label:"社会面",value:"1"}})],1)],1),t._v(" "),i("el-col",{directives:[{name:"show",rawName:"v-show",value:t.bzhshow,expression:"bzhshow"}],attrs:{span:24}},[i("span",{staticClass:"yy-input-text",attrs:{title:"标准化地址"}},[t._v("标准化地址：")]),t._v(" "),i("el-input",{staticClass:"yy-input-input",attrs:{placeholder:"请输入内容",size:"small"},model:{value:t.pd.bzhdz,callback:function(e){t.$set(t.pd,"bzhdz",e)},expression:"pd.bzhdz"}})],1),t._v(" "),i("el-col",{directives:[{name:"show",rawName:"v-show",value:t.lgshow,expression:"lgshow"}],attrs:{span:24}},[i("el-col",{attrs:{span:24}},[i("span",{staticClass:"yy-input-text"},[t._v("住宿宾馆：")]),t._v(" "),i("el-select",{staticClass:"yy-input-input",attrs:{placeholder:"请搜索",size:"small",filterable:"",clearable:"","filter-method":t.userFilter},model:{value:t.pd.zsbg,callback:function(e){t.$set(t.pd,"zsbg",e)},expression:"pd.zsbg"}},t._l(t.zsbg,function(t){return i("el-option",{key:t.dm,attrs:{label:t.mc,value:t.dm}})}),1)],1)],1)],1),t._v(" "),i("el-row",{attrs:{type:"flex"}},[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.doSearch()}}},[t._v("查询")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.doset()}}},[t._v("重置")])],1)],1)],1):t._e()])],1),t._v(" "),i("div",{staticClass:"bghome"},[i("el-dialog",{attrs:{title:t.diatext,visible:t.lzhDialogVisible},on:{"update:visible":function(e){t.lzhDialogVisible=e}}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[i("el-table-column",{attrs:{label:"照片"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.zp?i("div",[i("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[i("img",{staticStyle:{"max-width":"700px","max-height":"700px"},attrs:{src:e.row.zp}}),t._v(" "),i("img",{attrs:{slot:"reference",src:e.row.zp,alt:e.row.zp,width:"50",height:"50"},slot:"reference"})])],1):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"ywxm",label:"英文姓名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"zwxm",label:"中文姓名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"xb",label:"性别",width:"60"}}),t._v(" "),i("el-table-column",{attrs:{prop:"csrq",label:"出生日期"}}),t._v(" "),i("el-table-column",{attrs:{prop:"djrq",label:"登记日期"}}),t._v(" "),i("el-table-column",{attrs:{prop:"gjdq",label:"国家地区"}}),t._v(" "),i("el-table-column",{attrs:{prop:"zjzl",label:"证件种类"}}),t._v(" "),i("el-table-column",{attrs:{prop:"zjhm",label:"证件号码"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"yellow",cursor:"pointer"},on:{click:function(s){t.gotos(e.row.zjhm,e.row.gjdqdm)}}},[t._v(t._s(e.row.zjhm))])]}}])})],1),t._v(" "),i("div",{staticClass:"middle-foot mt-10"},[i("div",{staticClass:"page-msg"},[i("div",{staticClass:"crrcolor"},[t._v("\n            共"+t._s(t.TotalResult)+"条记录\n            ")]),t._v(" "),i("div",{staticClass:"crrcolor"}),t._v(" "),i("div",{staticClass:"crrcolor"})]),t._v(" "),i("el-pagination",{attrs:{background:"","current-page":t.CurrentPage,"page-size":t.pageSize,layout:"prev, pager, next",total:t.TotalResult},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.CurrentPage=e}}})],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("img",{staticStyle:{cursor:"pointer"},attrs:{src:s("JmKm"),border:"0"},on:{click:function(e){t.lzhDialogVisible=!1}}})]),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{left:"0px",top:"0px","border-bottom-width":"0","border-right-width":"0"}}),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{right:"0px",top:"0px","border-bottom-width":"0","border-left-width":"0"}}),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{left:"0px",bottom:"0px","border-top-width":"0","border-right-width":"0"}}),t._v(" "),i("div",{staticClass:"arrow_line",staticStyle:{right:"0px",bottom:"0px","border-top-width":"0","border-left-width":"0"}})],1)],1)])},staticRenderFns:[]};var b=s("VU/8")(u,h,!1,function(t){s("tJBl"),s("q3JR")},"data-v-089246e0",null);e.default=b.exports},q3JR:function(t,e){},tJBl:function(t,e){}});
//# sourceMappingURL=66.1a0e3e0fd673dc637bb4.js.map